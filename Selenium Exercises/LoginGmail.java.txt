package exercises;

import org.openqa.selenium.By;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.TimeoutException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

public class LoginGmail {
	public void execute(WebDriver driver) {

		
		// Open the webpage 
		driver.get(
		 "https://accounts.google.com/signin/v2/identifier?continue=https%3A%2F%2Fmail.google.com%2Fmail%2F&service=mail&sacu=1&rip=1&flowName=GlifWebSignIn&flowEntry=ServiceLogin"
		  );
		

		// Maximizar el navegador
		// driver.manage().window().maximize();

		// Create a Object wait of WebdriverWait class
		WebDriverWait wait = new WebDriverWait(driver, 5);

		// Valor del resultado final del test
		boolean result = false;

		try {
			// Nombre de usuario
			driver.findElement(By.xpath("//INPUT[@id='identifierId']")).clear();
			driver.findElement(By.xpath("//INPUT[@id='identifierId']")).sendKeys("usuario");

			// Boton siguiente
			driver.findElement(By.xpath("//SPAN[@class='RveJvd snByac'][text()='Siguiente']")).click();

			// Validacion cuando no se ingresa un usuario correcto con Explicit wait
			try {
				// Using ExpectedConditions wait until element visibility
				wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//DIV[@class='GQ8Pzc']")));

				if (driver.findElement(By.xpath("//DIV[@class='GQ8Pzc']")).isDisplayed()) {
					System.out.println("El nombre de usuario es incorrecto");
					result = false;
				}
			} catch (TimeoutException ex) {
				// No hay error en usuario

				// Contraseña
				driver.findElement(By.xpath("//INPUT[@type='password']")).clear();
				driver.findElement(By.xpath("//INPUT[@type='password']")).sendKeys("contrasena");

				// Boton siguiente
				driver.findElement(By.xpath("//SPAN[@class='RveJvd snByac'][text()='Siguiente']")).click();

				try {
					// Using ExpectedConditions wait until element visibility
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//DIV[@class='xgOPLd']")));

					if (driver.findElement(By.xpath("//DIV[@class='xgOPLd']")).isDisplayed()) {
						System.out.println("La contrasena es incorrecta");
						result = false;
					}
				} catch (TimeoutException ex2) {
					// No hay error en contrasena

					// Dashboard de usuario
					driver.findElement(By.xpath("//SPAN[@class='gb_xa gbii']")).click();
					// Boton Salir
					driver.findElement(By.xpath("//A[@id='gb_71']")).click();
					// Se completo el escenario
					result = true;

				}
			}

		} catch (NoSuchElementException ex) {
			System.out.println("No se encotro un elemento");
			result = false;
		} finally {
			// Valor del resultado final del test
			System.out.println("\nEl resultado del test fue: " + result);
			// Salir del navegador
			 driver.quit();
		}

	}

}
